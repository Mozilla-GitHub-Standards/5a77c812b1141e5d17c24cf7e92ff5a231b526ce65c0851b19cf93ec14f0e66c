{% extends "admin/base.html" %}

{% block main %}
  <form method="post" action="?" enctype="multipart/form-data">
    <input type="hidden" name="csrf" value="{{ csrf }}">
    <legend>
      {% if editing %}
        Edit Badge: {{ badge.name }}
      {% else %}
        New Badge
      {% endif %}
    </legend>

    <div>
      <label for="program">Program</label>
      <select id="program" name="program">
        <option>Select a Program</option>
        {% for issuer in issuers %}
        <optgroup label="{{issuer.name | e}}">
          {% for program in issuer.programs %}
            <option
               {% if badge.program.id == program.id %}
                 selected
               {% endif %}
               value="{{program.id}}">

               {{program.name | e}}
            </option>
          {% endfor %}
        </optgroup>
        {% endfor %}
      </select>
      <span class="help-block">
        The program this badge is associated with.
      </span>
    </div>

    <div>
      {{ badge | imageForBadge }}
      <label for="name">Name</label>
      <input
          id="name"
          type="text"
          name="name"
          value="{{ badge.name | default('') }}"
          placeholder="My Very Fancy Badge"
          required>
      <span class="help-block">
        This is the name for your badge, it should be descriptive, but
        also awesome.
      </span>
    </div>

    <div>
      <label for="description">Description</label>
      <textarea
          id="description"
          rows="5"
          name="description"
          maxlength="128"
          required>{{ badge.description | default('')}}</textarea>
      <span class="help-block">
        A description of your badge, this will appear in every assertion
        created from this badge.
      </span>
    </div>

    <div>
      <label for="criteria">Criteria</label>
      <textarea
          id="criteria"
          rows="5"
          name="criteria"
          required>{{ badge.criteria.content | default('')}}</textarea>
      <span class="help-block">
        The criteria text for the badge. This can be markdown, but don't
        go crazy, okay? Keep it simple. That also means you'll have to escape
        markup by wrapping it in backticks: <code>`&lt;strong&gt;`</code>
      </span>
    </div>

    <div>
      <label for="tags">Tags</label>
      <input type="text" name="tags" id="tags" value="{{badge.tags | join(', ') | e}}">
      <span class="help-block">
        Tags for the badge. Individual tags should be comma separated.
      </span>
    </div>

    <div>
      <label for="category">Category</label>
      <select id="category" name="category">
        <option value="science" {{ badge.category | selected('science') }}>Science</option>
        <option value="technology" {{ badge.category | selected('technology') }}>Technology</option>
        <option value="engineering" {{ badge.category | selected('engineering') }}>Engineering</option>
        <option value="art" {{ badge.category | selected('art') }}>Art</option>
        <option value="math" {{ badge.category | selected('math') }}>Math</option>
      </select>
    </div>

    <div>
      <label for="timeToEarn">Time to Earn</label>
      <select id="timeToEarn" name="timeToEarn">
        <option value="short" {{ badge.timeToEarn | selected('short') }}>1-4 hours</option>
        <option value="medium" {{ badge.timeToEarn | selected('medium') }}>1 day</option>
        <option value="long" {{ badge.timeToEarn | selected('long') }}>1 week</option>
      </select>
    </div>

    <div>
      <label for="ageRange">Age Range</label>
      <select id="ageRange" name="ageRange">
        <option value="0-13" {{ badge.ageRange | selected('0-13') }}>&lt;13</option>
        <option value="13-18" {{ badge.ageRange | selected('13-18') }}>13-18</option>
        <option value="19-24" {{ badge.ageRange | selected('19-24') }}>19-24</option>
      </select>
    </div>

    <div>
      <label for="type">Badge Type</label>
      <select id="type" name="type">
        <option value="self-paced" {{ badge.type | selected('self-paced') }}>Self-paced activity</option>
        <option value="in-person" {{ badge.type | selected('in-person') }}>In-person activity</option>
        <option value="participation" {{ badge.type | selected('participation') }}>Participation</option>
      </select>
    </div>

    <div>
      <label>
        List in APIs?
        <input name="list" type="checkbox" {% if badge.doNotList == false %}checked{% endif %}>
      </label>
      <span class="help-block">
        Whether or not this badge should be shown when an API call is
        made to list all of the badges. In most cases, this should be
        left checked.
      </span>
    </div>

    <div>
      <label for="image">New Image</label>
      <input
          type="file"
          name="image"
          accept="image/png"
          {% if not editing%} required {% endif %}>
      <span class="help-block">
        The image to use for the badge. It should be the greatest image
        known to man.
        {% if editing %} Leave blank to keep old image. {% endif %}
      </span>
    </div>

    <div class="form-actions">
      <button id="update-badge" type="submit" class="btn btn-primary">Update</button>
    </div>
  </form>
{% endblock %}

{% block footer %}
<script src="/js/admin.js"></script>
{% endblock %}
